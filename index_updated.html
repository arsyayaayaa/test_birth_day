<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday ‚Äì Baiq Ila Karunia üéâ</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
<style>
  :root{
    --bg: #121212;
    --pink:#ff6ec7;
    --yellow:#ffe066;
    --blue:#6ecbff;
    --green:#7CFF6E;
    --white:#fff;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(#151520,#0f0f15);
    color:var(--white); font-family:'Press Start 2P', cursive;
    overflow:hidden;
  }

  #hud{position:fixed; left:16px; top:12px; font-size:12px; opacity:.9}
  #gameWrap{display:flex; align-items:center; justify-content:center; height:100vh;}
  canvas{image-rendering:pixelated; background:
    linear-gradient(#87CEEB 60%, #55aa55 60%);
    border:4px solid #222; border-radius:8px; box-shadow:0 10px 30px rgba(0,0,0,.45);
  }
  .btnTip{position:fixed; bottom:14px; left:50%; transform:translateX(-50%);
    font-size:11px; opacity:.9; background:rgba(0,0,0,.35); padding:8px 10px; border-radius:8px}

  /* message box di atas bendera */
  #flagMessage {
    position: absolute;
    padding: 8px 12px;
    background: rgba(0,0,0,0.75);
    border: 2px solid var(--yellow);
    border-radius: 10px;
    font-size: 12px;
    color: var(--yellow);
    text-align: center;
    white-space: nowrap;
    display: none;
    transform: translate(-50%, -120%);
    pointer-events: none;
  }
</style>
</head>
<body>

<div id="hud">üéÇ Baiq Birthday Map ‚Äî <span id="coins">Coins: 0</span></div>

<div id="gameWrap" style="position:relative;">
  <canvas id="gameCanvas" width="960" height="540"></canvas>
  <div id="flagMessage">Kumpulkan semua koinnya dulu yaa cantiikkkk! ‚ú®</div>
</div>
<div class="btnTip">Controls: ‚Üê ‚Üí untuk bergerak ‚Ä¢ Spasi/‚Üë untuk lompat</div>

<script>
const c = document.getElementById('gameCanvas');
const ctx = c.getContext('2d');
const W = c.width, H = c.height;

let keys = {left:false, right:false, up:false};
addEventListener('keydown',e=>{
  if(['ArrowLeft','a','A'].includes(e.key)) keys.left=true;
  if(['ArrowRight','d','D'].includes(e.key)) keys.right=true;
  if(['ArrowUp','w','W',' '].includes(e.key)){ keys.up=true; e.preventDefault(); }
});
addEventListener('keyup',e=>{
  if(['ArrowLeft','a','A'].includes(e.key)) keys.left=false;
  if(['ArrowRight','d','D'].includes(e.key)) keys.right=false;
  if(['ArrowUp','w','W',' '].includes(e.key)) keys.up=false;
});

const GRAV = 0.55, MOVE = 0.9, JUMP = 12.4;
const player = {x:80, y:H-140, w:28, h:34, vx:0, vy:0, onGround:false, coins:0};

const platforms = [
  {x:0,y:H-80,w:1800,h:80, color:'#55aa55'},
  {x:260,y:H-160,w:80,h:20, color:'#ffc6e5'},
  {x:360,y:H-210,w:90,h:20, color:'#c6f1ff'},
  {x:500,y:H-260,w:110,h:20, color:'#fff0a8'},
  {x:680,y:H-210,w:110,h:20, color:'#c6ffd1'},
  {x:860,y:H-260,w:110,h:20, color:'#ffdada'},
  {x:1060,y:H-210,w:130,h:20, color:'#d6eaff'},
  {x:1260,y:H-260,w:120,h:20, color:'#fff0a8'},
];
const coins = [
  {x:300,y:H-190, r:8, got:false},
  {x:540,y:H-290, r:8, got:false},
  {x:740,y:H-240, r:8, got:false},
  {x:1120,y:H-240, r:8, got:false},
];

const goal = {x:1540, y:H-160, w:26, h:120};

let camX = 0, running = true;

/* draw flag */
function rect(x,y,w,h,color){ ctx.fillStyle=color; ctx.fillRect(x - camX, y, w, h); }
function drawFlag(){
  rect(goal.x, goal.y, goal.w, goal.h, '#444');
  ctx.fillStyle = '#ff6ec7';
  ctx.beginPath();
  ctx.moveTo(goal.x - camX + goal.w, goal.y);
  ctx.lineTo(goal.x - camX + goal.w + 60, goal.y + 18);
  ctx.lineTo(goal.x - camX + goal.w, goal.y + 36);
  ctx.closePath(); ctx.fill();
}

/* collisions */
function aabb(a,b){
  return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
}
function update(){
  if(keys.left) player.vx -= MOVE;
  if(keys.right) player.vx += MOVE;
  if(keys.up && player.onGround){ player.vy = -JUMP; player.onGround=false; }
  player.vy += GRAV; player.vx *= 0.92;

  player.x += player.vx;
  for(const p of platforms){
    if(aabb(player, p)){
      if(player.vx > 0) player.x = p.x - player.w;
      else if(player.vx < 0) player.x = p.x + p.w;
      player.vx = 0;
    }
  }
  player.y += player.vy; player.onGround=false;
  for(const p of platforms){
    if(aabb(player, p)){
      if(player.vy > 0){ player.y = p.y - player.h; player.vy=0; player.onGround=true; }
      else if(player.vy < 0){ player.y = p.y + p.h; player.vy=0; }
    }
  }
  if(player.y + player.h > H-80){ player.y = H-80 - player.h; player.vy=0; player.onGround=true; }

  for(const c of coins){
    if(!c.got){
      const dx = player.x + player.w/2 - c.x;
      const dy = player.y + player.h/2 - c.y;
      if(dx*dx + dy*dy < (c.r+14)*(c.r+14)){
        c.got = true; player.coins++;
        document.getElementById('coins').textContent = 'Coins: '+player.coins;
      }
    }
  }

  camX = Math.max(0, Math.min(player.x - W*0.35, 900));

  if(aabb(player, goal)){
    if(player.coins < coins.length){
      showFlagMessage();
    }else{
      win();
    }
  }else{
    hideFlagMessage();
  }
}

function render(){
  ctx.clearRect(0,0,W,H);
  ctx.fillStyle='#ffe066';
  ctx.fillRect(40 - camX, 60, 280, 14);
  ctx.fillStyle='#000'; ctx.font="14px 'Press Start 2P'";
  ctx.fillText("HAPPY BIRTHDAY MAP", 50 - camX, 72);
  for(const p of platforms) rect(p.x, p.y, p.w, p.h, p.color);
  for(const co of coins){
    if(co.got) continue;
    const x = co.x - camX, y = co.y;
    ctx.fillStyle='#ffde59';
    ctx.beginPath(); ctx.arc(x,y,co.r,0,Math.PI*2); ctx.fill();
    ctx.strokeStyle='#b48b00'; ctx.lineWidth=2; ctx.stroke();
  }
  drawFlag();
  rect(player.x, player.y, player.w, player.h, '#ff4d4d');
}

function loop(){ if(!running) return; update(); render(); requestAnimationFrame(loop); }
loop();

/* win state */
function win(){ running=false; alert("üéâ Selamat! Semua koin terkumpul! üéâ"); }

/* pesan di atas bendera */
function showFlagMessage(){
  const msg = document.getElementById('flagMessage');
  msg.style.display = 'block';
  msg.style.left = (goal.x - camX + goal.w/2) + 'px';
  msg.style.top  = goal.y + 'px';
}
function hideFlagMessage(){
  document.getElementById('flagMessage').style.display = 'none';
}
</script>
</body>
</html>
